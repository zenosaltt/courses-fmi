\chptr{Congruenza e Aritmetica Modulare}

\section{Congruenza in modulo}
\begin{tcolorbox}[colback=yellow!30, colframe=yellow!30!black, title=Congruenza in Modulo $n$]
Fissiamo $n \in \mathbb{Z}$. Siano $a,b \in \mathbb{Z}$. Diciamo
che $a$ è congruo a $b$ modulo $n$ e scriveremo: \[ a \equiv b \Mod{n} \]
se vale: \[n|(a-b)\]
\end{tcolorbox}

Uno dei significati intuitivi della congruenza in modulo è il seguente:
se $a$ è congruo a $b$ modulo $n$, allora il resto della divisione euclidea
di $a$ per $n$ e quello della divisione euclidea di $b$ per $n$ sono uguali.
Anche la congruenza è una relazione di equivalenza, che vale su $\mathbb{Z}$.
Infatti essa gode delle proprietà (si fissa $n\in\mathbb{Z}$):
\begin{enumerate}
\item \textbf{Riflessiva:} \[ \forall a \in \mathbb{Z}, a \equiv a \Mod{n} \]
\item \textbf{Simmetrica:} \[ \forall a,b \in \mathbb{Z}, a \equiv b \Mod{n} \Longrightarrow b \equiv a \Mod{n} \]
\item \textbf{Transitiva:} \[\forall a,b,c \in \mathbb{Z}: a \equiv b \Mod{n} \text{ e } b \equiv c \Mod{n} \Longrightarrow a \equiv c \Mod{n} \]
\end{enumerate}

\section{Quoziente insiemistico}
Prima di procedere con le proprietà della conguenza in modulo, estendiamo
il discorso sulle relazioni di equivalenza introducendo nuovi concetti e
strumenti molto astratti ma altrettanto utili nella trattazione dell'aritmetica
modulare.
\vspace*{10pt}
\begin{tcolorbox}[colback=yellow!30, colframe=yellow!30!black, title=Classe di Equivalenza]
Siano $X$ un insieme e $\mathcal{R}$ una relazione di equivalenza
su $X$. Fissiamo $x \in X$. Definiamo la classe di equivalenza di $x$ in
$X$ rispetto a $\mathcal{R}$ (oppure classe di $\mathcal{R}-$equivalente
di $x$, oppure $\mathcal{R}-$classe di $x$):
\[ [x]_\mathcal{R} := \{y \in X| y \mathcal{R} x\} \]
\end{tcolorbox}

\begin{tcolorbox}[colback=yellow!30, colframe=yellow!30!black, title=Insieme Quoziente]
Definiremo l'insieme quoziente di $X$ modulo $\mathcal{R}$ che indicheremo
con $X/_\mathcal{R}$ ponendo:
\[ X/_{\mathcal{R}}:= \{[x]_\mathcal{R} \in 2^X | x \in X \} = \bigcup_{x \in X} \{[x]_\mathcal{R}\} \subseteq 2^X \]
Ovvero l'insieme i cui elementi sono tutte e sole le $\mathcal{R}$-classi in $X$.
\end{tcolorbox}

\section{Classi di congruenza}

\section{Struttura algebrica di $\mathbb{Z}/_{n\mathbb{Z}}$}
Sia $n>0$. Siano $a,a',b,b' \in \mathbb{Z}$ tali che
$[a]_n = [a']_n \text{ e } [b]_n = [b']_n $.
Valgono:
\begin{enumerate}
\item $[a+b]_n = [a'+b']_n$, ovvero $a+b \equiv a'+b' \Mod{n}$
\item $[a \cdot b]_n = [a' \cdot b']_n$, ovvero $a \cdot b \equiv a' \cdot b' \Mod{n}$
\end{enumerate}
Dalle precedenti proposizioni si possono definire le operazioni di
somma e prodotto tra classi di resto:
\begin{align*}
[a]_n+[b]_n &= [a+b]_n\\
[a]_n[b]_n &= [ab]_n
\end{align*}
Si può altresì dimostrare che le operazioni
di somma e prodotto tra classi di congruenza godono delle
stesse proprietà di quelle in $\mathbb{Z}$:
\begin{enumerate}
\item \textbf{Associatività:}\\$([a]_n + [b]_n) + [c]_n = [a]_n + ([b]_n + [c]_n) \quad ([a]_n[b]_n)[c]_n = [a]_n([b]_n[c]_n)$
\item \textbf{Commutatività:} $[a]_n + [b]_n = [b]_n + [a]_n \qquad [a]_n[b]_n = [b]_n[a]_n$
\item \textbf{Distributività:} $[a]_n([b]_n+[c]_n) = [a]_n[b]_n + [a]_n[c]_n$
\item \textbf{Elemento neutro:} $[a]_n + [0]_n = [a]_n \qquad [a]_n[1]_n = [a]_n$
\item \textbf{Elemento assorbente:} $[a]_n[0]_n = 0$
\end{enumerate}
Tuttavia è interessante notare altre proprietà peculiari:
\begin{enumerate}
\item \textit{Classi nulle come prodotto tra classi non nulle:} \[ 2 \cdot 3 = 0 \text{ in } \mathbb{Z}/_{6\mathbb{Z}} \]
\item \textit{Somma fino a 0:} se $n>0$, allora: \[ \sum_{i=1}^{n} 1 = 0 \quad \text{in } \mathbb{Z}/_{n\mathbb{Z}} \]
\end{enumerate}
Da qui il nome intuitivo di \textit{regola dell'orologio}: la caratteristica delle classi
di resto è proprio il fatto che i numeri che vi appartengono non si trovano su una
retta o semiretta, bensì su una circonferenza. Fu Gauss ad illustrare per primo
questa intuizione.

Ricordate dalle elementari quelle regole di divisibilità per 3, 4, 11 e così via?
Ecco la dimostrazione della regola di divisibilità per 3 (vogliamo mostrare che un
naturale è divisibile per 3 se e solo se la somma delle sue cifre lo è; la
dimostrazione delle altre regole è analoga):

$\\$
\textit{\textbf{Dimostrazione:}} sia $n$ un naturale espresso in base decimale
le cui cifre sono $\varepsilon_0,...,\varepsilon_k$ dalla meno alla più significativa.
Ricordando il teorema di rappresentabilità in base arbitraria dei naturali, vale:
\begin{align*}
    &[n]_3 = [\varepsilon_0\cdot10^0+...+\varepsilon_k\cdot10^k]_3=[\varepsilon_0]_3[10]^0_3+...+[\varepsilon_k]_3[10]^k_3=\\
    = &[\varepsilon_0][1]^0_3+...+[\varepsilon_k][1]^k_3=[\varepsilon_0+...+\varepsilon_k]_3
\end{align*}

Scrivendo in modo compatto:
\begin{align*}
 &[n]_3 = \left[ \sum_{i=0}^{k}\varepsilon_i10^i \right]_3 = \sum_{i=0}^{k}[\varepsilon_i10^i]_3 = \sum_{i=0}^{k}[\varepsilon_i]_3[10]^i_3 =\\
= &\sum_{i=0}^{k}[\varepsilon_i]_3[1]^i_3 = \sum_{i=0}^{k}[\varepsilon_i]_3 = \left[\sum_{i=0}^{k}\varepsilon_i\right]_3
\end{align*}

Dunque, esprimendo la condizione di divisibilità:
\[ [n]_3 = [0]_3 \Longleftrightarrow \left[\sum_{i=0}^{k}\varepsilon_i\right]_3 = [0]_3 \]
appunto, $n$ è divisibile per (o multiplo di) 3 se e solo se la somma delle sue cifre è multipla di (o divisibile per) 3.
\cvd


\section{\underline{Teorema cinese del resto}}
\begin{tcolorbox}[enhanced, breakable, title={Teolema cinese del lesto}]
Siano $n,m>0$ e siano $a,b \in \mathbb{Z}$. Consideriamo il seguente problema:
\[
    \begin{cases}
        x \in \mathbb{Z}\\
        x \equiv a \Mod{n}\\
        x \equiv b \Mod{m}
    \end{cases}
    \Longleftrightarrow
    \begin{cases}
        x \in \mathbb{Z}\\
        [x]_n = [a]_n\\
        [x]_m = [b]_m
    \end{cases}
\]
Indichiamo con $S$ l'insieme delle soluzioni del precedente sistema di congruenze:
$S:=\{ x \in \mathbb{Z}| x \equiv a \Mod{n}, x \equiv b \Mod{m} \}$.
Allora il sistema è compatibile se e solo se $a \equiv b \Mod{(n,m)}$, ovvero:
\[ S\not = \varnothing \Longleftrightarrow (n,m)|a-b \]
Assumiamo che $S \not = \varnothing$ e sia $c\in S$. Allora:
\begin{align*}
    S &=[c]_{[n,m]} \subseteq \mathbb{Z}\\
    &=\{ c+k[n,m] \in \mathbb{Z}| k \in \mathbb{Z} \}
\end{align*}

\emph{\textbf{Dimostrazione:}} \underline{\emph{Compatibilità:}} Assumiamo che
$S \not = \varnothing \Rightarrow \exists c \in S$ ovvero:
\[
    \begin{cases}
        c \equiv a \Mod{n}\\
        c \equiv b \Mod{m}
    \end{cases}
    \Longleftrightarrow
    \begin{cases}
        c = a+kn\\
        c = b+hm
    \end{cases}
\]
per qualche $h,k \in \mathbb{Z}$. Vale: $ 0 = a+kn - b-hm \Leftrightarrow -kn+hm = a-b $.
Ma dato che $(n,m)|n$ e $(n,m)|m$, per il lemma utile $(n,m)|-kn+hm = a-b$.

Assumiamo ora che valga $(n,m)|a-b$. Vale, per qualche $k \in \mathbb{Z}$:
\begin{align}
    a-b = k(n,m)
\end{align}
Applichiamo l'algoritmo di euclide con sostituzione a ritroso ad $n$ e $m$, ottenendo la
combinazione lineare:
\begin{align}
    (n,m) = xn+ym
\end{align}
per qualche $x,y \in \mathbb{Z}$. Grazie a (1) e (2) vale:
\begin{align*}
    &a-b=k(n,m)=k(xn+ym)=kxn+kym \Leftrightarrow\\
    \Leftrightarrow &a+(-kx)n=b+(ky)m =: c \in S
\end{align*}

\underline{\emph{Soluzione:}} Sia $c \in S$ e proviamo che $S=[c]_{[n,m]} \subseteq \mathbb{Z}$.
Mostriamo che $S \subseteq [c]_{[n,m]}$. Sia $c'\in S$. Vale:
\[ c \in S \Longleftrightarrow
    \begin{cases}
        c \equiv a \Mod{n}\\
        c \equiv b \Mod{m}
    \end{cases}
    \Longleftrightarrow
    \begin{cases}
        c = a+kn\\
        c = b+hm
    \end{cases}
\]
\[
    c' \in S \Longleftrightarrow
    \begin{cases}
        c' \equiv a \Mod{n}\\
        c' \equiv b \Mod{m}
    \end{cases}
    \Longleftrightarrow
    \begin{cases}
        c' = a+k'n\\
        c' = b+h'm
    \end{cases}
\]
per qualche $h,h',k,k' \in \mathbb{Z}$. Vale:
\[ c'-c=k'n-kn=(k'-k)n \quad\text{ e }\quad c'-c=h'm-hm=(h'-h)m \]
dunque
\[ n|c'-c,m|c'-c \Longrightarrow [n,m]|c'-c \Longleftrightarrow c'\equiv c \Mod{[n,m]} \Longleftrightarrow c' \in [c]_{[n,m]} \]
Mostriamo che $[c]_{[n,m]} \subseteq S$. Sia $c' \in [c]_{[n,m]}$, ovvero $c'=c+k[n,m]$ per qualche
$k \in \mathbb{Z}$. Vale:
\begin{align*}
    [c']_n &=\\
    &= [c+k[n,m]]_n =\\
    &= [c]_n + [k[n,m]]_n =\\
    &= [a]_n + [k]_n \cdot [[n,m]]_n =\\
    &= [a+k\cdot 0]_n = [a]_n
\end{align*}
Lo stesso procedimento vale per $m$: $[c']_m = [b]_m$. Dunque $c'\in S$.
Avendo mostrato che $S\subseteq[c]_{[n,m]}$ e $[c]_{[n,m]}\subseteq S$,
allora $S = [c]_{[n,m]}\subseteq\mathbb{Z}$.
\cvd
\end{tcolorbox}

\section{Invertibilità}
\section{La funzione $\Phi$ di Eulero}
\section{\underline{Teorema di Fermat-Eulero}}
\section{\underline{RSA}}


\section{Metodi di calcolo: orbita di una classe}
Le proprietà dell'aritmetica modulare consentono di effettuare calcoli (in modulo)
a mano nonostante ci si dovesse imbattere in numeri estremamente grandi.
Anche se il calcolo manuale non riscuote molto successo al giorno d'oggi,
esistono ancora alcuni sistemi, come le calcolatrici, che impiegano
tecniche di aritmetica modulare per semplificare i calcoli e trattare
numeri altrimenti enormi rispetto alla capacità di rappresentazione digitale
del dispositivo.
Tecniche di calcolo simili si fondano su alcuni principi esaminati in
questa parte:
\begin{itemize}
\item equivalenza tra classi di resto;
\item somma e prodotto tra classi di resto;
\item teorema di Fermat-Eulero, insieme a generalizzazioni e corollari;
\item orbita.
\end{itemize}
Supponiamo di voler calcolare il resto della divisione intera tra
$4^{2465}$ e $3$. Calcolare esplicitamente il dividendo non sarebbe
molto efficiente, ma, conoscendo ora l'aritmetica modulare, sappiamo
che il problema è interpretabile come segue:
\[ \text{si trovi il minimo } r\in\mathbb{Z},r\geq0: [r]_3 = [4^{2465}]_3 \]
Dunque applichiamo le proprietà algebriche: $[4^{2465}]_3 = [4]^{2465}_3 = [1]_3^{2465} = [1^{2465}]_3 = [1]_3 \Rightarrow r = 1$.
Supponiamo ora di voler identificare la cifra delle unità di $7^{222}$.
Con un po' di ragionamento si imposta il problema come segue\footnote{In un naturale espresso in
base decimale, la cifra delle unità corrisponde al resto della divisione tra il numero stesso e 10.}:
\[ d\in\{0,...,9\}: 7^{222}\equiv d\Mod{10} \]
Notiamo che 7 e 10 sono coprimi, quindi per il teorema di Fermat-Eulero
$7^{\Phi(10)}\equiv 1 \Mod{10}$, dove $\Phi(10)=\Phi(2\cdot5)=4$. Ma
allora $7^{222}\equiv 7^{4\cdot55+2} \equiv (7^4)^{55}\cdot7^2\equiv 1^{55}\cdot 49 \equiv 49\equiv 9 \Mod{10} \Rightarrow d=9$.

Illustriamo il concetto di orbita di una classe di resto con la seguente tabella,
prendendo l'esempio di $[8]_{77}$:
\begin{center}
\begin{tabular}{c|l}
    \head{$k$} & \head{Rappresentante di $[8^k]_{77}$}\\
    \hline
    1        & $8$\\
    2        & $64$\\
    3        & $50$\\
    4        & $15$\\
    5        & $43$\\
    6        & $36$\\
    7        & $57$\\
    8        & $71$\\
    9        & $29$\\
    10       & $1$\\
    11       & $8$\\
    12       & $64$\\
    \dots    & \dots
\end{tabular}
\end{center}
Notiamo che all'esponente 10 abbiamo ottenuto il rappresentante
1. Per i principi dell'aritmetica modulare ciò accade sempre. Ma
quello che è ancor più sorprendente è che questa successione è periodica
(provate a proseguire con i calcoli con $k>10$): questa è l'orbita
della classe $[8]_{77}$ elevata a potenze positive. La formulazione
rigorosa di questa proprietà si collega al teorema di Carmichael.

La tecnica dell'orbita permette, in alcuni casi, di velocizzare i calcoli in
modulo in due modi: trovare rappresentanti canonici ridotti e agevoli
da maneggiare o raggiungere la classe 1 senza ripiegare sul teorema
di Fermat-Eulero. Questa tecnica può tornare utile in alcuni
contesti (si vedano gli esercizi) ma non è sempre conveniente. Per esempio,
l'orbita potrebbe essere più lunga di quello che si potrebbe pensare.